<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Peta Tematik Fasilitas Kesehatan Lowokwaru</title>
    <meta
      name="description"
      content="WebGIS Interaktif Persebaran Fasilitas Kesehatan di Kecamatan Lowokwaru, Kota Malang"
    />

    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />

    <!-- jsPDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>

    <style>
      :root {
        --primary: #2563eb;
        --primary-light: #3b82f6;
        --secondary: #0d9488;
        --accent: #f59e0b;
        --gray-100: #f8fafc;
        --gray-200: #e2e8f0;
        --gray-700: #334155;
        --gray-900: #0f172a;
        --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.1);
        --shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
        --shadow-lg: 0 10px 30px rgba(0, 0, 0, 0.12);
        --radius: 16px;
        --transition: all 0.35s cubic-bezier(0.4, 0, 0.2, 1);
      }

      *,
      *::before,
      *::after {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      body {
        font-family: "Inter", sans-serif;
        background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
        color: var(--gray-900);
        line-height: 1.6;
        min-height: 100vh;
        -webkit-font-smoothing: antialiased;
      }

      /* Header */
      header {
        background: linear-gradient(135deg, var(--primary) 0%, #1e40af 100%);
        color: white;
        padding: 5rem 1rem 4rem;
        text-align: center;
        position: relative;
        overflow: hidden;
      }

      header::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320"><path fill="%23ffffff" fill-opacity="0.08" d="M0,160L48,176C96,192,192,224,288,213.3C384,203,480,149,576,133.3C672,117,768,139,864,170.7C960,203,1056,245,1152,245.3C1248,245,1344,203,1392,181.3L1440,160L1440,320L0,320Z"></path></svg>')
          bottom no-repeat;
        background-size: cover;
      }

      .header-content {
        max-width: 1200px;
        margin: 0 auto;
        position: relative;
        z-index: 2;
      }

      h1 {
        font-family: "Poppins", sans-serif;
        font-size: clamp(2rem, 5vw, 3.2rem);
        font-weight: 700;
        margin-bottom: 1rem;
        text-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
      }

      .subtitle {
        font-size: clamp(1rem, 3vw, 1.3rem);
        opacity: 0.95;
        max-width: 800px;
        margin: 0 auto;
        font-weight: 300;
      }

      /* Container */
      .container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 2rem 1rem;
      }

      /* Section */
      .section {
        background: white;
        border-radius: var(--radius);
        padding: clamp(1.5rem, 4vw, 2.5rem);
        margin-bottom: 2rem;
        box-shadow: var(--shadow);
        border: 1px solid rgba(255, 255, 255, 0.3);
        position: relative;
        overflow: hidden;
        transition: var(--transition);
      }

      .section::before {
        content: "";
        position: absolute;
        left: 0;
        top: 0;
        bottom: 0;
        width: 6px;
        background: linear-gradient(
          to bottom,
          var(--primary),
          var(--secondary)
        );
      }

      .section:hover {
        transform: translateY(-8px);
        box-shadow: var(--shadow-lg);
      }

      h2 {
        font-family: "Poppins", sans-serif;
        color: var(--primary);
        font-size: clamp(1.5rem, 4vw, 1.9rem);
        margin-bottom: 1.5rem;
        display: flex;
        align-items: center;
        gap: 12px;
      }

      h2 i {
        color: var(--secondary);
        font-size: 1.4em;
      }

      /* Stats Grid */
      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
        gap: 1rem;
        margin: 2rem 0;
      }

      .stat-card {
        background: linear-gradient(135deg, #ffffff, #f8fafc);
        padding: 1.5rem;
        border-radius: var(--radius);
        text-align: center;
        box-shadow: var(--shadow-sm);
        border: 1px solid var(--gray-200);
        transition: var(--transition);
      }

      .stat-card:hover {
        transform: translateY(-5px);
        box-shadow: var(--shadow);
      }

      .stat-number {
        font-size: clamp(2.2rem, 5vw, 3rem);
        font-weight: 700;
        color: var(--primary);
        font-family: "Poppins", sans-serif;
        min-height: 60px;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .stat-label {
        color: var(--gray-700);
        font-size: 0.9rem;
        margin-top: 0.5rem;
      }

      /* Benefits */
      .benefits-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 1.2rem;
        margin-top: 1.5rem;
      }

      .benefit-card {
        background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
        border-radius: var(--radius);
        padding: 1.6rem;
        border-left: 5px solid var(--primary);
        transition: var(--transition);
      }

      .benefit-card:hover {
        transform: translateX(8px);
        box-shadow: var(--shadow);
        background: linear-gradient(135deg, #dbeafe, #bfdbfe);
      }

      .benefit-card h3 {
        color: var(--primary);
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 0.8rem;
        font-size: 1.15rem;
      }

      /* Layout Peta Preview - BARU */
      .layout-preview {
        position: relative;
        border-radius: var(--radius);
        overflow: hidden;
        box-shadow: var(--shadow-lg);
        margin: 2rem 0;
      }

      .layout-preview img {
        width: 100%;
        height: auto;
        display: block;
        transition: transform 0.5s ease;
      }

      .layout-preview:hover img {
        transform: scale(1.03);
      }

      .layout-caption {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        background: linear-gradient(transparent, rgba(0,0,0,0.85));
        color: white;
        padding: 2.5rem 1.8rem 1.8rem;
        text-align: center;
      }

      .layout-caption strong {
        font-size: 1.25rem;
        display: block;
        margin-bottom: 0.4rem;
      }

      /* Map Preview */
      .map-preview {
        position: relative;
        border-radius: var(--radius);
        overflow: hidden;
        box-shadow: var(--shadow-lg);
        margin: 2rem 0;
        cursor: pointer;
        aspect-ratio: 16 / 9;
      }

      .map-preview img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: transform 0.5s ease;
      }

      .map-preview:hover img {
        transform: scale(1.08);
      }

      .map-overlay {
        position: absolute;
        inset: 0;
        background: linear-gradient(
          135deg,
          rgba(37, 99, 235, 0.95),
          rgba(13, 148, 136, 0.95)
        );
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        opacity: 0;
        transition: var(--transition);
        color: white;
        text-align: center;
        padding: 2rem;
        backdrop-filter: blur(4px);
      }

      .map-preview:hover .map-overlay {
        opacity: 1;
      }

      /* Buttons */
      .btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
        padding: 14px 28px;
        border-radius: 50px;
        font-weight: 600;
        text-decoration: none;
        transition: var(--transition);
        cursor: pointer;
        border: none;
        font-size: 1rem;
        min-height: 52px;
        width: 100%;
        max-width: 320px;
      }

      .btn-primary {
        background: var(--primary);
        color: white;
        box-shadow: 0 4px 15px rgba(37, 99, 235, 0.4);
      }

      .btn-primary:hover {
        background: #1d4ed8;
        transform: translateY(-3px);
        box-shadow: 0 8px 25px rgba(37, 99, 235, 0.5);
      }

      .btn-outline {
        background: transparent;
        color: var(--primary);
        border: 2px solid var(--primary);
      }

      .btn-outline:hover {
        background: var(--primary);
        color: white;
      }

      .btn-group {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
        gap: 1rem;
        margin: 2rem 0;
        justify-items: center;
      }

      /* Facilities List */
      .facilities-list {
        max-height: 420px;
        overflow-y: auto;
        background: var(--gray-100);
        border-radius: var(--radius);
        padding: 0.8rem;
        border: 1px solid var(--gray-200);
      }

      .facility-item {
        padding: 1rem;
        border-bottom: 1px solid var(--gray-200);
        border-radius: 10px;
        margin-bottom: 0.6rem;
        transition: var(--transition);
      }

      .facility-item:hover {
        background: white;
        box-shadow: var(--shadow-sm);
        transform: translateY(-2px);
      }

      .facility-name {
        font-weight: 600;
        color: var(--primary);
        font-size: 1.05rem;
      }

      .facility-address {
        font-size: 0.9rem;
        color: #555;
        margin-top: 0.3rem;
      }

      /* Profile */
      .profile {
        text-align: center;
        padding: 2rem 1rem;
      }
      .profile-img {
        width: 130px;
        height: 130px;
        border-radius: 50%;
        background: linear-gradient(135deg, var(--primary), var(--secondary));
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 1.5rem;
        font-size: 3rem;
        color: white;
        box-shadow: var(--shadow-lg);
      }

      .contact-info {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 0.8rem;
        margin-top: 1.5rem;
      }

      .contact-link {
        padding: 0.8rem 1.4rem;
        background: white;
        color: var(--primary);
        border-radius: 50px;
        text-decoration: none;
        display: flex;
        align-items: center;
        gap: 8px;
        box-shadow: var(--shadow-sm);
        transition: var(--transition);
        font-size: 0.95rem;
        min-width: 140px;
      }

      .contact-link:hover {
        background: var(--primary);
        color: white;
        transform: translateY(-3px);
      }

      /* Footer */
      footer {
        background: var(--gray-900);
        color: white;
        text-align: center;
        padding: 3rem 1rem;
        margin-top: 4rem;
        font-size: 0.95rem;
      }

      /* Responsive */
      @media (max-width: 480px) {
        .container {
          padding: 1rem;
        }
        .btn-group {
          grid-template-columns: 1fr;
        }
        .benefits-grid {
          grid-template-columns: 1fr;
        }
        .stats-grid {
          grid-template-columns: repeat(2, 1fr);
          gap: 0.8rem;
        }
        header {
          padding: 4rem 1rem 3rem;
        }
      }

      @media (min-width: 768px) {
        .btn {
          width: auto;
        }
        .btn-group {
          grid-template-columns: repeat(3, max-content);
        }
      }

      @media (min-width: 1024px) {
        .stats-grid {
          grid-template-columns: repeat(4, 1fr);
        }
        .benefits-grid {
          grid-template-columns: repeat(3, 1fr);
        }
      }
    </style>
  </head>
  <body>
    <header>
      <div class="header-content">
        <h1>Peta Tematik Fasilitas Kesehatan</h1>
        <p class="subtitle">
          WebGIS Interaktif Persebaran 10 Fasilitas Kesehatan di Kecamatan
          Lowokwaru, Kota Malang
        </p>
      </div>
    </header>

    <div class="container">
      <!-- Deskripsi Proyek -->
      <section class="section">
        <h2><i class="fas fa-info-circle"></i> Deskripsi Proyek</h2>
        <p>
          Peta tematik ini merupakan hasil analisis spasial menggunakan Sistem
          Informasi Geografis (SIG) untuk memetakan persebaran fasilitas
          kesehatan di Kecamatan Lowokwaru. Terdapat
          <strong>10 fasilitas kesehatan</strong> dengan
          <strong>7 layer peta</strong> interaktif yang mendukung analisis
          komprehensif.
        </p>

        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-number">0</div>
            <div class="stat-label">Fasilitas Kesehatan</div>
          </div>
          <div class="stat-card">
            <div class="stat-number">0</div>
            <div class="stat-label">Layer Peta</div>
          </div>
          <div class="stat-card">
            <div class="stat-number">0%</div>
            <div class="stat-label">Data Terverifikasi</div>
          </div>
          <div class="stat-card">
            <div class="stat-number">0/7</div>
            <div class="stat-label">Akses Online</div>
          </div>
        </div>
      </section>

      <!-- Tujuan & Manfaat -->
      <section class="section">
        <h2><i class="fas fa-bullseye"></i> Tujuan & Manfaat</h2>
        <div class="benefits-grid">
          <div class="benefit-card">
            <h3><i class="fas fa-chart-pie"></i> Analisis Kesenjangan</h3>
            <p>
              Mengidentifikasi wilayah dengan akses layanan kesehatan terbatas.
            </p>
          </div>
          <div class="benefit-card">
            <h3><i class="fas fa-hospital"></i> Perencanaan Faskes Baru</h3>
            <p>Menentukan lokasi optimal berdasarkan analisis coverage area.</p>
          </div>
          <div class="benefit-card">
            <h3><i class="fas fa-users"></i> Pemerataan Akses</h3>
            <p>Mendukung pemerataan layanan kesehatan bagi seluruh warga.</p>
          </div>
          <div class="benefit-card">
            <h3><i class="fas fa-cogs"></i> Keputusan Berbasis Data</h3>
            <p>
              Menyajikan visualisasi yang mudah dipahami oleh pengambil
              kebijakan.
            </p>
          </div>
          <div class="benefit-card">
            <h3><i class="fas fa-search-location"></i> Pemantauan Spasial</h3>
            <p>Memantau perkembangan distribusi faskes dari waktu ke waktu.</p>
          </div>
          <div class="benefit-card">
            <h3><i class="fas fa-graduation-cap"></i> Edukasi Masyarakat</h3>
            <p>Meningkatkan awareness tentang fasilitas kesehatan terdekat.</p>
          </div>
        </div>
      </section>

      <!-- SECTION BARU: Layout Peta (disisipkan di sini) -->
      <section class="section">
        <h2><i class="fas fa-image"></i> Layout Peta</h2>
        <p>
          Berikut adalah tampilan statis peta tematik yang menunjukkan persebaran fasilitas kesehatan beserta elemen kartografi pendukung seperti batas administrasi, jalan utama, dan legenda.
        </p>

        <div class="layout-preview">
          <img src="peta/images/Layout Peta Faskes Lowokwaru.jpg" alt="Layout Peta Tematik Fasilitas Kesehatan Kecamatan Lowokwaru" />
          <div class="layout-caption">
            <strong>Peta Tematik Fasilitas Kesehatan</strong><br>
            Kecamatan Lowokwaru, Kota Malang s<br>
            <small>10 Fasilitas Kesehatan • 7 Layer Tematik • Tahun 2025</small>
          </div>
        </div>
      </section>

      <!-- Peta Interaktif -->
      <section class="section">
        <h2><i class="fas fa-map-marked-alt"></i> Peta Interaktif</h2>
        <p>
          Klik gambar di bawah untuk membuka peta tematik interaktif lengkap
          dengan fitur pencarian, pengukuran, dan popup informasi.
        </p>

        <div
          class="map-preview"
          onclick="window.open('peta/index.html', '_blank')"
        >
          <img
            src="peta/images/preview-peta.png"
            alt="Preview Peta Lowokwaru"
          />
          <div class="map-overlay">
            <h3>
              <i class="fas fa-external-link-alt"></i> Buka Peta Interaktif
            </h3>
            <p>Jelajahi 10 fasilitas kesehatan dengan 7 layer peta</p>
          </div>
        </div>

        <div class="btn-group">
          <a href="peta/index.html" target="_blank" class="btn btn-primary">
            <i class="fas fa-map"></i> Buka Peta Sekarang
          </a>
          <button class="btn btn-outline" id="downloadDataBtn">
            <i class="fas fa-download"></i> Unduh Data Faskes
          </button>
          <button class="btn btn-outline" id="downloadAnalysisBtn">
            <i class="fas fa-file-pdf"></i> Laporan Analisis
          </button>
        </div>

        <h3 style="margin: 2rem 0 1rem; color: var(--primary)">
          Daftar Fasilitas Kesehatan
        </h3>
        <div class="facilities-list">
          <div class="facility-item">
            <div class="facility-name">Klinik Panti Rahayu</div>
            <div class="facility-address">
              Jl. Simpang Borobudur No.1, Mojolangu • Telp: 085173021670
            </div>
          </div>
          <div class="facility-item">
            <div class="facility-name">Puskesmas Mojolangu</div>
            <div class="facility-address">
              Jl. Sudimoro No.17 A, Mojolangu • Telp: 0341482905
            </div>
          </div>
          <div class="facility-item">
            <div class="facility-name">Puskesmas Kendalsari</div>
            <div class="facility-address">
              Jl. Cengger Ayam I No.8, Tulusrejo • Telp: 0341478215
            </div>
          </div>
          <div class="facility-item">
            <div class="facility-name">Puskesmas Pembantu Jatimulyo</div>
            <div class="facility-address">Jl. Simbar Menjangan, Jatimulyo</div>
          </div>
          <div class="facility-item">
            <div class="facility-name">Puskesmas Pembantu TunggulWulung</div>
            <div class="facility-address">
              Jl. Arumba No.4, Tunggulwulung • Telp: 0341484174
            </div>
          </div>
          <div class="facility-item">
            <div class="facility-name">UPTD Puskesmas Pembantu Sumbersari</div>
            <div class="facility-address">
              Jl. Sigura - Gura No.29, Sumbersari • Telp: 0341581442
            </div>
          </div>
          <div class="facility-item">
            <div class="facility-name">Puskesmas Dinoyo</div>
            <div class="facility-address">
              Jl. Mt Haryono 9 No.13, Dinoyo • Telp: 0341572640
            </div>
          </div>
          <div class="facility-item">
            <div class="facility-name">Klinik THT Terpadu Malang</div>
            <div class="facility-address">
              Jl. Cengkeh No.63, Tulusrejo • Telp: 03414376509
            </div>
          </div>
          <div class="facility-item">
            <div class="facility-name">Klinik Widya Husada</div>
            <div class="facility-address">
              Jl. Sudimoro No.16, Mojolangu • Telp: 085236855950
            </div>
          </div>
          <div class="facility-item">
            <div class="facility-name">Rumah Sakit Universitas Brawijaya</div>
            <div class="facility-address">
              Jl. Soekarno Hatta, Lowokwaru • Telp: 0341403000
            </div>
          </div>
        </div>
      </section>

      <!-- Profil Pembuat -->
      <section class="section">
        <h2><i class="fas fa-user-graduate"></i> Profil Pembuat</h2>
        <div class="profile">
          <div class="profile-img">SDC</div>
          <h3>Septian Dwi Cahya</h3>
          <p>NIM: 23201032 • Teknik Informatika</p>
          <img
            src="peta/images/Logo ASIA.png"
            alt="ITB ASIA Malang"
            style="height: 80px; margin: 1rem 0; border-radius: 12px"
          />
          <p><em>Institut Teknologi dan Bisnis ASIA Malang</em></p>
          <div class="contact-info">
            <a
              href="https://instagram.com/t_rats87"
              target="_blank"
              class="contact-link"
              ><i class="fab fa-instagram"></i> Instagram</a
            >
            <a
              href="https://wa.me/6281259456586"
              target="_blank"
              class="contact-link"
              ><i class="fab fa-whatsapp"></i> WhatsApp</a
            >
            <a
              href="mailto:tiancahya755@gmail.com"
              target="_blank"
              class="contact-link"
              ><i class="fas fa-envelope"></i> Email</a
            >
          </div>
        </div>
      </section>
    </div>

    <footer>
      <p>© 2025 Peta Tematik Fasilitas Kesehatan Kecamatan Lowokwaru</p>
      <p>
        Dibuat dengan ❤️ untuk mendukung pemerataan akses kesehatan masyarakat
      </p>
      <p style="margin-top: 0.5rem; opacity: 0.8">
        Institut Teknologi dan Bisnis ASIA Malang
      </p>
    </footer>

    <script>
      // Data fasilitas kesehatan
      const facilitiesData = [
        {
          nama: "Klinik Panti Rahayu",
          alamat: "Jl. Simpang Borobudur No.1, Mojolangu",
          telepon: "085173021670",
          jenis: "Klinik",
        },
        {
          nama: "Puskesmas Mojolangu",
          alamat: "Jl. Sudimoro No.17 A, Mojolangu",
          telepon: "0341482905",
          jenis: "Puskesmas",
        },
        {
          nama: "Puskesmas Kendalsari",
          alamat: "Jl. Cengger Ayam I No.8, Tulusrejo",
          telepon: "0341478215",
          jenis: "Puskesmas",
        },
        {
          nama: "Puskesmas Pembantu Jatimulyo",
          alamat: "Jl. Simbar Menjangan, Jatimulyo",
          telepon: "-",
          jenis: "Puskesmas Pembantu",
        },
        {
          nama: "Puskesmas Pembantu TunggulWulung",
          alamat: "Jl. Arumba No.4, Tunggulwulung",
          telepon: "0341484174",
          jenis: "Puskesmas Pembantu",
        },
        {
          nama: "UPTD Puskesmas Pembantu Sumbersari",
          alamat: "Jl. Sigura - Gura No.29, Sumbersari",
          telepon: "0341581442",
          jenis: "Puskesmas Pembantu",
        },
        {
          nama: "Puskesmas Dinoyo",
          alamat: "Jl. Mt Haryono 9 No.13, Dinoyo",
          telepon: "0341572640",
          jenis: "Puskesmas",
        },
        {
          nama: "Klinik THT Terpadu Malang",
          alamat: "Jl. Cengkeh No.63, Tulusrejo",
          telepon: "03414376509",
          jenis: "Klinik Spesialis",
        },
        {
          nama: "Klinik Widya Husada",
          alamat: "Jl. Sudimoro No.16, Mojolangu",
          telepon: "085236855950",
          jenis: "Klinik",
        },
        {
          nama: "Rumah Sakit Universitas Brawijaya",
          alamat: "Jl. Soekarno Hatta, Lowokwaru",
          telepon: "0341403000",
          jenis: "Rumah Sakit",
        },
      ];

      // Animasi angka halus
      function animateValue(el, start, end, duration, suffix = "") {
        let startTime = null;
        const animation = (currentTime) => {
          if (!startTime) startTime = currentTime;
          const elapsed = currentTime - startTime;
          const progress = Math.min(elapsed / duration, 1);
          const ease = 1 - Math.pow(1 - progress, 4);
          const value = Math.floor(ease * (end - start) + start);
          el.textContent = value + suffix;
          if (progress < 1) requestAnimationFrame(animation);
        };
        requestAnimationFrame(animation);
      }

      // Jalankan semua fungsi saat halaman siap
      document.addEventListener("DOMContentLoaded", function () {
        // Tombol PDF
        document
          .getElementById("downloadDataBtn")
          .addEventListener("click", exportDataToPDF);
        document
          .getElementById("downloadAnalysisBtn")
          .addEventListener("click", exportAnalysisToPDF);

        // Animasi counter saat section Deskripsi Proyek terlihat
        const statsSection = document.querySelector(".section:first-of-type");
        const statsObserver = new IntersectionObserver(
          (entries) => {
            if (entries[0].isIntersecting) {
              const nums = document.querySelectorAll(".stat-number");
              animateValue(nums[0], 0, 10, 2000, "");
              animateValue(nums[1], 0, 7, 2000, "");
              animateValue(nums[2], 0, 100, 2200, "%");
              animateValue(nums[3], 0, 24, 2200, "/7");
              statsObserver.unobserve(statsSection);
            }
          },
          { threshold: 0.5 }
        );
        statsObserver.observe(statsSection);
      });

      // Export Data Faskes ke PDF
      function exportDataToPDF() {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        doc
          .setFontSize(20)
          .setTextColor(26, 115, 232)
          .text("DATA FASILITAS KESEHATAN", 105, 20, { align: "center" });
        doc
          .setFontSize(12)
          .setTextColor(100, 100, 100)
          .text("Kecamatan Lowokwaru, Kota Malang", 105, 28, {
            align: "center",
          });
        doc
          .setFontSize(10)
          .text(
            `Dicetak pada: ${new Date().toLocaleDateString("id-ID")}`,
            105,
            35,
            { align: "center" }
          );

        const rows = facilitiesData.map((f, i) => [
          i + 1,
          f.nama,
          f.alamat,
          f.telepon,
          f.jenis,
        ]);
        doc.autoTable({
          head: [["No", "Nama Faskes", "Alamat", "Telepon", "Jenis"]],
          body: rows,
          startY: 45,
          theme: "grid",
          styles: { fontSize: 9 },
          headStyles: { fillColor: [26, 115, 232], textColor: 255 },
        });
        doc.save("Data_Fasilitas_Kesehatan_Lowokwaru.pdf");
      }

      // Export Laporan Analisis ke PDF
      function exportAnalysisToPDF() {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        doc
          .setFontSize(20)
          .setTextColor(26, 115, 232)
          .text("LAPORAN ANALISIS FASILITAS KESEHATAN", 105, 20, {
            align: "center",
          });
        doc
          .setFontSize(12)
          .setTextColor(100, 100, 100)
          .text("Kecamatan Lowokwaru, Kota Malang", 105, 28, {
            align: "center",
          });

        let y = 45;
        doc.setFontSize(11).setTextColor(0).text("ANALISIS STATISTIK", 20, y);
        y += 15;
        const jenisCount = {};
        facilitiesData.forEach(
          (f) => (jenisCount[f.jenis] = (jenisCount[f.jenis] || 0) + 1)
        );
        doc.setFontSize(10);
        doc.text(`Total Fasilitas: ${facilitiesData.length}`, 25, y);
        y += 8;
        Object.entries(jenisCount).forEach(([j, c]) => {
          doc.text(`${j}: ${c} unit`, 25, y);
          y += 7;
        });

        doc.setFontSize(11).text("ANALISIS SPASIAL & REKOMENDASI", 20, y + 10);
        const points = [
          "• Terdapat 10 fasilitas kesehatan yang tersebar",
          "• Distribusi terkonsentrasi di permukiman padat",
          "• Puskesmas menjadi jenis terbanyak (4 unit)",
          "• Akses terbaik di sekitar jalan utama",
          "• Rekomendasi: Penambahan faskes di wilayah pinggiran",
        ];
        y += 20;
        points.forEach((p) => {
          doc.text(p, 25, y);
          y += 8;
        });

        doc.save("Laporan_Analisis_Faskes_Lowokwaru.pdf");
      }
    </script>
  </body>
</html>